pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
-- main

function _init()
	cls()
end

function _update60()
	alt.update()
end

function _draw()
	cls()
	map()
	print(alt.x/8)
	print(alt.y/8)
	alt.draw()
end
-->8
-- actor

function make_actor(x,y)
	return {
		x=x or 0,
		y=y or 0,
		mvs={},
		vx=0,
		vy=0,
		spd=0.6,
		accl=0.1,
		dccl=0.9,
		hitw=0.4,
		hith=0.4,
		face=1,
		spr=0
	}
end
-->8
-- player

plr = make_actor(64,64)
plr.spr = 32
plr.update = function()
	local dx = 0
	local dy = 0
end

plr.draw = function()
	spr(plr.spr,plr.x-4,plr.y-4)
end

plr.update = function()
	local dx = 0
	local dy = 0
	if btn(⬅️) then
		dx -= 1
	end
	if btn(➡️) then
		dx += 1
	end
	if btn(⬆️) then
		dy -= 1
	end
	if btn(⬇️) then
		dy += 1
	end
	
	if dx == 0 then
		if abs(plr.vx) > 0 then
			--deccelerate
			plr.vx *= plr.dccl
			if abs(plr.vx) < 0.1 then
				plr.vx = 0
			end
		end
	else
		plr.vx += dx * plr.accl * plr.spd
		if abs(plr.vx) > plr.spd then
			plr.vx = plr.spd * dx
		end
	end
	if dy == 0 then
		if abs(plr.vy) > 0 then
			--deccelerate
			plr.vy *= plr.dccl
			if abs(plr.vy) < 0.1 then
				plr.vy = 0
			end
		end
	else
		plr.vy += dy * plr.accl * plr.spd
		if abs(plr.vy) > plr.spd then
			plr.vy = plr.spd * dy
		end
	end
	
	plr.x += plr.vx
	plr.y += plr.vy
end

plr.move = function()
end
-->8
alt = make_actor(64,64)
alt.spr = 32

alt.update = function()
	alt.handle_input()
	alt.move()
end

alt.move = function()
	if #alt.mvs == 0 then
		return
	end
	local dx,dy = unpack(alt.mvs[1])
	if alt.x ~= dx then
		local sign = alt.x - dx > 0 and -1 or 1
		alt.x += sign * 1
	end
	if alt.y ~= dy then
		local sign = alt.y - dy > 0 and -1 or 1
		alt.y += sign * 1
	end
	if alt.x == dx and alt.y == dy then
		alt.pop_mvs()
	end
end

alt.draw = function()
	spr(alt.spr, alt.x, alt.y)
end

alt.handle_input = function()
	mx = 0
	my = 0
	if btnp(⬅️) then
		mx = -8
	elseif btnp(➡️) then
		mx = 8
	elseif btnp(⬆️) then
		my = -8
	elseif btnp(⬇️) then
		my = 8
	end
	if mx ~= 0 or my ~= 0 then
		local from_x,from_y = unpack(#alt.mvs and alt.mvs[#alt.mvs] or {alt.x,alt.y})
		mx += from_x
		my += from_y
		if alt.can_move_to(mx/8, my/8) then
			alt.mvs[#alt.mvs+1] = {mx,my}
		end
	end
end

alt.can_move_to = function(x,y)
	return fget(mget(x,y)) == 0
end

alt.pop_mvs = function()
	del(alt.mvs, alt.mvs[1])
end
__gfx__
00000000555555556666666644444444111111119999999900000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555555556666666644444444111111119aaaaaa900000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700555555556666666644444444111111119a9999a900000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000555555556666666644444444111111119a9aa9a900000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000555555556666666644444444111111119a9aa9a900000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700555555556666666644444444111111119a9999a900000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555555556666666644444444111111119aaaaaa900000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555555556666666644444444111111119999999900000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666667666766666666655555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666667766776666666655155155000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66556655665566556655556655555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666666666666656656651555515000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666676667666656656651555515000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666677667766655556655555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
65566556655665566666666655155155000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666666666666666666655555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00535000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00181000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
03535300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
03353300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
08535800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000101010101010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000
__gff__
0001000100001400000000000000000000020409000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0101010101010505010101010101010101010101010101010101010101010101010101010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101020201050505050102020101011010101010101010101010101010101010100113020202020202020202010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0102020201050505050102020201100210100202020202020202020202020202020302020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0102020201050505050102020201011010101010101010101010101010101010100102020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0102020201050505050102020201010101010101010101010101010101010101010102020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0102020202020202020202020201010202020202020202020202020101010202010102020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0102020202020202020202020203020202020202020202020202020203020202020102020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0102020202020202020202020203020202020202020202020202020203020202020102020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0102020202020202020202020201010202020202020202020202020101020202020102020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0102020202020202020202020201010101010101010101010101010101020202020102020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0102020202020202020202020201010202020202020202020202020101020202020102020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0102020202020202020202020201020202020202020202020202020201020202020102020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101020202020202020202020101020202020202020202020202020201020202020102020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010303010101010101020202020202020202020202020201020202020102020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000001020202020202020202020202020201020202020102020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000001020202020202020202020202020201020202020102020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000001020202020202020202020202020201020202020102020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000001020202020202020202020202020203020202020102020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000001020202020202020202020202020203100202020102020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000001020202020202020202020202020201010202010102020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000001020202020202020202020202020201010101010102020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000001020202020202020202020202020201010202010102020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000001010202020202020202020202020201020202020312020202020202020202021300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000001010101010101030301010101010101020202020312020202020202020202021300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000001010202020202020202020202020202020202020101020202020202020202010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000001020202020202020202020202020202020202020101010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000001020202020202020202020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000001020202020202020202020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000001020202020202020202020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000001020202020202020202020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000001020202020202020202020202020202020202020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000001010202020202020202020202020202020202010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
